@use "lib/viewport";
@import "online";
@import "chart";
@import "time";
@import "birthday";
@import "profile";
@import "top-contributors";
@import "top-topics";
@import "cta";
@import "banner";

.blocks.--top {
  container-type: inline-size;
  display: flex;
  justify-content: center;
  background: linear-gradient(135deg, var(--neutral-100) 0%, var(--primary-very-low) 100%);
  border-bottom: var(--border-outer);
  position: relative;
  overflow: hidden;

  &::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(circle at 30% 20%, rgba(var(--tertiary-rgb), 0.05) 0%, transparent 50%);
    pointer-events: none;
  }

  .blocks__wrapper {
    container-type: inline-size;
    display: grid;
    grid-template-columns: repeat(12, 4rem);
    gap: 1.5rem;
    align-items: stretch;
    justify-content: center;
    box-sizing: content-box;
    box-sizing: border-box;
    width: 59rem;
    height: 100%;
    max-height: 19rem;
    padding: 1.5rem;
    background-repeat: no-repeat;
    background-position: 100% 50%;
    background-size: 47rem;

    @container (max-width: 59rem) {
      display: flex;
      flex-direction: column;
      gap: 1rem;
    }

    .blocks__row {
      display: grid;
      grid-column: span 12;
      grid-template-columns: repeat(12, 4rem);
      gap: 1.5rem;

      .block {
        --bg: transparent;
      }

      @container (max-width: 59rem) {
        display: flex;
        flex-direction: column;
        gap: 1rem;
      }
    }
  }
}

#main-outlet-wrapper {
  .blocks {
    width: 100%;
    padding-top: 2rem;
    padding-bottom: 2rem;

    @include viewport.until(lg) {
      padding-top: 1rem;
      padding-bottom: 1rem;
    }

    &__wrapper {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
      width: 19rem;
    }

    &__row {
      &:not(:has(.block--4w)) {
        display: grid;
        grid-auto-rows: 4rem;
        grid-template-columns: repeat(4, 4rem);
        gap: 1.5rem;
        align-items: stretch;
      }
    }
  }
}

.block {
  --br: var(--rounded-#{$blocks_border_radius});
  --b: 0;
  --bg: var(--neutral-100);
  position: relative;
  overflow: var(--o, hidden);
  display: flex;
  grid-column: var(--w, span 1);
  grid-row: var(--h, span 1);
  flex-direction: var(--fd, row);
  align-items: var(--ai, flex-start);
  justify-content: var(--jc, flex-start);
  box-sizing: border-box;
  padding: var(--p, 0.75rem);
  color: var(--neutral-10);
  background: var(--bg, var(--neutral-100));
  border: var(--b, none);
  border-radius: var(--br, var(--rounded-xl));
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.04), 0 1px 3px rgba(0, 0, 0, 0.06);
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  backdrop-filter: blur(10px);

  &:hover {
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08), 0 3px 10px rgba(0, 0, 0, 0.1);
  }

  &::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 3px;
    background: linear-gradient(90deg, var(--tertiary), var(--quaternary));
    border-radius: var(--rounded-xl) var(--rounded-xl) 0 0;
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  &:hover::before {
    opacity: 1;
  }

  &--4w {
    --w: span 4;
    --h: auto;
  }

  &--2x1 {
    --w: span 2;
    --h: span 1;
  }

  &--2x2 {
    --w: span 2;
    --h: span 2;
  }

  &--4x1 {
    --w: span 4;
    --h: span 1;
  }

  &--4x2 {
    --w: span 4;
    --h: span 2;
  }

  &--4x4 {
    --w: span 4;
    --h: span 4;
  }

  &--4x6 {
    --w: span 4;
    --h: span 6;
  }

  &--4x8 {
    --w: span 4;
    --h: span 8;
  }

  // Enhanced block variants
  &--featured {
    background: linear-gradient(135deg, var(--tertiary-very-low) 0%, var(--quaternary-very-low) 100%);
    border: 1px solid var(--tertiary-low);
    
    &::before {
      opacity: 1;
    }
  }

  &--accent {
    background: linear-gradient(135deg, var(--tertiary) 0%, var(--quaternary) 100%);
    color: var(--secondary);
    
    * {
      color: var(--secondary) !important;
    }
  }

  &--glass {
    background: rgba(255, 255, 255, 0.1);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.2);
  }
}

.block-user {
  --w: span 4;
}
